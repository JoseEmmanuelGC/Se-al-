<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Gráfica de señal</title>
  </head>
  <body>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <div id="chart_div"></div>
  </body>

  <script>
    google.charts.load('current', {packages: ['corechart', 'line']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
      const POINTS_PER_SECOND = 60
      const POINTS_PER_UNIT = 10
      const START_TIME = 0
      const WIDTH = 20

      // Functions<<<
      function func(x) {
        return Math.sin(x);
      }
      function funcPlusNoise(x) {
        return Math.sin(x) + Math.sin(x / 5)
      }

      function firstData() {
        start = START_TIME * POINTS_PER_UNIT
        limit = start + (WIDTH * POINTS_PER_UNIT)
        array = [];
        for (var i = start; i < limit; i++) {
          timeFixed = i / POINTS_PER_UNIT
          values = [timeFixed, func(timeFixed), funcPlusNoise(timeFixed)];
          array.push(values);
        }
        return array;
      }

      function addData() {
        time += 1;
        timeFixed = time / POINTS_PER_UNIT
        data.removeRow(0);
        data.addRow([timeFixed, func(timeFixed), funcPlusNoise(timeFixed)]);
        chart.draw(data, options)
      }
      // >>>Functions

      let time = (START_TIME + WIDTH) * POINTS_PER_UNIT;

      var data = new google.visualization.DataTable();
      data.addColumn('number', '');
      data.addColumn('number', 'sen(x)');
      data.addColumn('number', 'sen(x) + sin(x/5)');

      data.addRows(firstData());

      var options = {
        hAxis: {
          title: 'x',
        },
        vAxis: {
          minValue: -4, 
          maxValue: 4
        },
        colors: ['#a52714', '#097138'],
        curveType: 'function',
      };

      var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
      chart.draw(data, options);

      setInterval(addData, 1000 / POINTS_PER_SECOND)
    }
  </script>
</html>
